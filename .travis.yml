language: cpp
matrix:
  include:
    - os: linux
      env: NAME="clang-format"
      sudo: required
      dist: trusty
      services: docker
      install: "./.travis/clang-format/deps.sh"
      script: "./.travis/clang-format/build.sh"
    - os: linux
      env: NAME="linux build"
      sudo: required
      dist: trusty
      services: docker
      addons:
        apt:
          packages:
            - p7zip-full
      install: "./.travis/linux/deps.sh"
      script: "./.travis/linux/build.sh"
      after_success: "./.travis/linux/upload.sh"
      cache: ccache
    - os: osx
      env: NAME="macos build"
      sudo: false
      osx_image: xcode10.2
      install: "./.travis/macos/deps.sh"
      script: "./.travis/macos/build.sh"
      after_success: "./.travis/macos/upload.sh"
      cache: ccache
    - os: linux
      env: NAME="MinGW build"
      sudo: required
      dist: trusty
      services: docker
      addons:
        apt:
          packages:
            - p7zip-full
      install: "./.travis/linux-mingw/deps.sh"
      script: "./.travis/linux-mingw/build.sh"
      after_success: "./.travis/linux-mingw/upload.sh"
      cache: ccache

deploy:
  provider: releases
  api_key:
    secure: "XKuybG6dEWychsIpj+cg+86BdYyOwb0qcyBpYlAJWtzPQFfGlqpuNxybqitGuAbe3r50XEe6jGrEnLrv6Q6dBrmaIGdzAyF79iqLi6l8L8ROSKuWjBJXUpWGpJBmixjYfbyTQdCnKcKLn6B+YlVtyn7NrP+jvcybqGYhdvvUhsk5p7zdy8e85+CVg2Mixw2/tMLkwNZ7zK+cNnUJ/zfGN6ezHqsf8GKRUtUBzFshQDhAzpVPXpRzZrlDO+ctjyckIMfdlIDx6Iwqy04vLm0NLGDTxCbfKgiiiAOhrzetmRmE6CdAHoHPIeAen99j6Dy9r2nkUK1VfIp42tFpdVsGFPFtO4foiV2UmZXzMWEh0XhwnLNSSn9H+AowqvbOAHh/dlF5ubMtlNAokq5OsbRiMhjxF4WqbLen32FbNeH3zkQdpbqHqE6KKQt1WnQmFzkrkFvyKRYZ7ORChTNKJyCF2cOnRxfu0ds1UtlC/+0mkCFMxfF+TKcbMVFbhlPLNBiR171Br9kUI4wgvKRCB6vRKgsZF1CmSMOaAeVwvGgpV9kuqzD3vgehSvOeqoRsyRPMllYCQ4Z5AINsdfiXvv6NCPh+QmTxLM7g2J6Pw38rIq/aLTyYSchkTEti5SsIabeJHmXYYZpmSOHPXqGXbpMVNmPxJEWKYRVDSPgtQLzX0Kg="
  file_glob: true
  file: "artifacts/*"
  skip_cleanup: true

notifications:
  webhooks:
    urls:
      - https://api.yuzu-emu.org/code/travis/notify
